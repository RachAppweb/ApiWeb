<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User's Post</title>

    <!-- <link rel="stylesheet" href="./node_modules/bootstrap/dist/css/bootstrap.min.css"> -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
    <!-- <script src="./node_modules/bootstrap/dist/js/bootstrap.min.js"></script> -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
   <!-- ======= LOADER ======== -->
 <div id="loader"  style="background: rgba(128, 128, 128, 0.495); position: fixed; top: 0px; bottom: 0px; left: 0px; right: 0px; margin: auto auto; display: flex; justify-content: center; align-items: center; z-index: 9999; width: 100px; height: 100px; border-radius: 20px;">
  <div class="lds-ring">
      <div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div>
  </div>
</div>
<!-- =======// LOADER //======== -->
    <!-- modal login -->
    <div id="close">
        <div class="modal fade" id="exampleModale" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h1 class="modal-title fs-5" id="exampleModalLabel">Log in</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <form>
                  <div class="mb-3">
                    <label for="recipient-name" class="col-form-label">Username</label>
                    <input type="text" class="form-control" id="username">
                  </div>
                  <div class="mb-3">
                    <label for="message-text" class="col-form-label">Password</label>
                    <input type="password" class="form-control" id="password">
                  </div>
                </form>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" >Close</button>
                <button type="button" class="btn btn-primary" onclick="loginBtn()">Log in</button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- end modal login -->
<!-- modal register -->
<div id="close">
    <div class="modal fade" id="rexampleModale" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel">Register New User</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form>
              <div class="mb-3">
                <label for="recipient-name" class="col-form-label">Name</label>
                <input type="text" class="form-control" id="rname">
              </div>
              <div class="mb-3">
                <label for="recipient-name" class="col-form-label">Image</label>
                <input type="file" class="form-control" id="rimage">
              </div>
              <div class="mb-3">
                <label for="recipient-name" class="col-form-label">Username</label>
                <input type="text" class="form-control" id="rusername">
              </div>
              <div class="mb-3">
                <label for="message-text" class="col-form-label">Password</label>
                <input type="password" class="form-control" id="rpassword">
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" >Close</button>
            <button type="button" class="btn btn-primary" onclick="registerBtn()">Register</button>
          </div>
        </div>
      </div>
    </div>
  </div>
   <!-- end modal register -->
      <!-- Allert -->
<div id="liveAlert"style="position:fixed;z-index:999999;bottom:0;right:0;"></div>

<!-- EndAlert -->

<div class="container w-70 p-3 " >
    <nav class="navbar navbar-expand-lg bg-body-tertiary rounded-1 p-3 shadow">
        <div class="container-fluid">
          <a class="navbar-brand" href="#">Rach</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="index.html">Home</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" onclick="profileClicked()" style="cursor: pointer;">Profile</a>
              </li>
              
            </ul>
            <div class="d-flex w-100 justify-content-end" id="logsign">
            <button type="button" class="btn btn-outline-success mx-2"data-bs-toggle="modal" data-bs-target="#exampleModale" data-bs-whatever="@fat" id="login">Log in</button>
            <button type="button" class="btn btn-outline-success " data-bs-toggle="modal" data-bs-target="#rexampleModale" data-bs-whatever="@fat" id="register">Sign up</button>
        </div>
        <div class="d-flex w-100 justify-content-end"  id="after">
          <img class="rounded-circle" src="./images/user_icon.jpg" alt=""style="width:40px;height:40px;"id="PROimage"><b id="PROname">User</b>
            <button type="button" class="btn btn-outline-danger "onclick="logOutBtn()" id="logoute">Log out</button>
        </div>
          </div>
        </div>
      </nav>
  </div>
  <!--style="margin-left:15px;"-->
  <div class="container mt-4" id="holder">
  <div class="container mt-4 "id="postOWNER">
  <h1>User's Post</h1>
</div>
  <div class="container mt-4 w-100" >
    
    <div class="card w-90 shadow pt-2 mt-3">
        <div><img class="rounded-circle " src="./images/user_icon.jpg" alt=""style="width:40px;height:40px;"id="imagePro"><b id="name">User</b></div>
        <div class="card-body " >
        <img class="w-100 " style="border-color:gray; border-style:solid; border-radius:10px;" src="./images/user_post.jpg" id="image" alt="">
        <h6 id="created" class="p-2">
           07/04/2023
        </h6>
        <h3 id="title" >hello</h3>
        <p id="text">Lorem ipsum dolor, sit amet </p>
        <hr style="color:rgb(24, 3, 3); " class="mt-1">
        <div>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil" viewBox="0 0 16 16">
                <path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"/>
              </svg>
        <span id="comment">( 3 )Comments</span>
     
        <span class="bar">tags</span>
    </div>
    <div id="comcontainer">

    
    <div id="comments" class="mt-3 mb-4 ">
        <div id="comment">
            <img src="./images/user_icon.jpg" alt="" class="rounded-circle"style="width:40px;height: 40px;">
            <b>User</b>
        </div>
        <div id="commbody">
            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Repellat ducimus officia unde, dolore dolorum, sed, quasi aspernatur reiciendis nemo corporis velo?
        </div>
    </div>
    </div>
    <!-- comment form -->
    <div class="row row-cols-xl g-5 w-100 justify-content-center">
        <div class="col-6">
          <div class="input-group w-100">           
            <input type="text" class="form-control" id="commentA" placeholder="Enter Your Comment">
          </div>
        </div>
        <div class="col-2  ">
          <button type="submit" class="btn btn-success justify-content-center" id="Pcomm">Post</button>
        </div>
      </div>
    <!-- //comment form // -->
    
    
</div>
    
    
            
  </div>
  </div>
  <script src= "./node_modules/axios/dist/axios.min.js"></script>
    <script src="./see.js"></script>
    <script src="./main.js"></script>
    <script>
        setupUI()
        setup()
        const urlSearch=new URLSearchParams(window.location.search)
        let id=urlSearch.get("postId")
        //console.log(id)
        getUsersPosts()
        function getUsersPosts(){
          loaderFunc(true)
            let holder=document.getElementById("holder")
            axios.get(`${baseUrl}/posts/${id}`)
            
            .then(function(response){
              
            // console.log(response.data.data)   
             
             
         
                 
                 let commcontent=``
                 for(let comment of response.data.data.comments)
                 
                 commcontent+=`
                 
                    <div id="comment"class="mt-3">
                      ${comment.author.profile_image ? 
                        `<img src="${comment.author.profile_image}" alt="" class="rounded-circle"style="width:40px;height: 40px;">`:
                        `<img src="./images/shoes.jpg" alt="" class="rounded-circle"style="width:40px;height: 40px;">`}
                        <b>${comment.author.name}</b>
                    </div>
                    <div id="commbody"class="mt-3">
                       ${comment.body}
                    </div>
                
                
                 `
                 var content=`
                  <div class="container mt-4 "id="postOWNER">
                    <h1>${response.data.data.author.name}'sPost</h1>
                  </div>
                    <div class="container mt-4 w-100" >
                      
                      <div class="card w-90 shadow pt-2 mt-3">
                          ${response.data.data.author.profile_image?
                            `<div><img class="rounded-circle " src="${response.data.data.author.profile_image}" alt=""style="width:40px;height:40px;"id="imagePro"><b id="name">${response.data.data.author.name}</b></div>`:
                            `<div><img class="rounded-circle " src="./images/wallpapersden.com_roronoa-zoro-one-piece-4k_1920x1080.jpg" alt=""style="width:40px;height:40px;"id="imagePro"><b id="name">${response.data.data.author.name}</b></div>` }
                          <div class="card-body " >
                          <img class="w-100 " style="border-color:gray; border-style:solid; border-radius:10px;" src="${response.data.data.image}" id="image" alt="">
                          <h6 id="created" class="p-2">
                            ${response.data.data.created_at}
                          </h6>
                          <h3 id="title" >${response.data.data.title}</h3>
                          <p id="text">${response.data.data.body} </p>
                          <hr style="color:rgb(24, 3, 3); " class="mt-1">
                          <div>
                              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil" viewBox="0 0 16 16">
                                  <path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"/>
                                </svg>
                          <span id="comment">(${response.data.data.comments_count})Comments</span>
                       
                          <span class="bar">tags</span>
                      </div>
                      <div id="comments" class="mt-3 ">

                           ${commcontent}
                        
                        
                        
                           
                            
                    </div>
                    <!-- comment form -->
                    
                    <div class="row row-cols-xl g-5 w-100 justify-content-center"id="commentform">
                        <div class="col-6">
                          <div class="input-group w-100 ">           
                            <input type="text" class="form-control" id="commentA" placeholder="Enter Your Comment">
                          </div>
                        </div>
                        <div class="col-2  ">
                          <button type="submit" onclick="createComm()" class="btn btn-success justify-content-center" id="Pcomm">Post</button>
                        </div>
                      </div>
                    <!-- //comment form // --> 
                       
                    </div>
                </div>
             `
             
           holder.innerHTML=content
           setup()
           
             })
             .catch((error)=>{
              showAlert(`${error.response.data.message}`, `danger`)
          }).finally(()=>{
            loaderFunc(false)
        })
        }
            function setup(){
            let token =localStorage.getItem("token")
            let commentA = document.getElementById("commentA");
            let Pcomm = document.getElementById("Pcomm");
            if(token==null){
              commentA.style.setProperty("display", "none", "important");
              Pcomm.style.setProperty("display", "none", "important");
            }else{
              commentA.style.setProperty("display", "flex", "important");
              Pcomm.style.setProperty("display", "flex", "important");
            }
            }
          
            function createComm(){
                let commentA=document.getElementById("commentA").value
                let params={
                    "body":commentA
                }
                let token=localStorage.getItem("token")
                let headers={
                    "authorization":`Bearer ${token}`
                }
                loaderFunc(true)
                axios.post(`${baseUrl}/posts/${id}/comments`,params,{
                    headers:headers
                }).then((response)=>{
                    //console.log(response)
                    showAlert(`The comment has been created successfully`, `success`)
                    getUsersPosts()
                }).catch((error)=>{
                    showAlert(`${error.response.data.message}`, `danger`)
                }).finally(()=>{
                  loaderFunc(false)
              })
            }
 
             
             
         
         
        
          //end get posta
     </script>

    </body>

</html> 